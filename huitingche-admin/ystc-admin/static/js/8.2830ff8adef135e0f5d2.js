webpackJsonp([8],{"6Wwh":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Xxa5"),o=n.n(r),i=n("exGp"),a=n.n(i),s=n("Dd8w"),u=n.n(s),d=n("yOOA"),c=n("gyMJ"),l=n("R4Sj"),m=n("+RYy"),g=n.n(m),p={components:{tabledata:d.a,VDistpicker:g.a},data:function(){var e=this;this.$createElement;return{tableColumns:[{type:"selection",width:60,align:"center"},{title:"停车场名称",align:"center",key:"parkingLotName"},{title:"停车场编号",align:"center",key:"parkingLotNumber"},{title:"泊位号",align:"center",key:"positionNumber"},{title:"设备编号",align:"center",key:"deviceId"},{title:"地磁编号",align:"center",key:"geomagnetismNumber"},{title:"路段管理员",align:"center",render:function(e,t){return e("div",[t.row.managerName?t.row.managerName:"暂无"])},key:"managerName"},{title:"管理员联系方式",align:"center",key:"phone"},{title:"创建时间",render:function(e,t){return e("div",t.row.createTime.slice(0,t.row.createTime.length-5))}},{title:"操作",align:"center",width:220,render:function(t,n){return t("div",[t("Button",{style:{"margin-right":"10px"},on:{click:function(){e.$Modal.confirm({title:"操作确认",content:"确认删除吗？",onOk:function(){e.deleteParkingPosition(n.row)}})}}},"删除"),t("Button",{on:{click:function(){e.editParkingPositionForm=n.row,e.showEditParkingPositionBox=!0}}},"编辑")])}}],queryUrl:c.u,queryData:{},page:1,num:10,type:"json",findeCondition:"",searchValue:"",conditionList:[{name:"查看全部",key:"0"},{name:"车位编号",key:"positionNumber"},{name:"停车场编号",key:"parkingLotNumber"},{name:"管理员名称",key:"managerName"}],addPositionForm:{positionNumber:"",deviceId:"",geomagnetismNumber:""},showParkingAddBox:!1,editPositionFormRule:{positionNumber:[{required:!0,message:"请输入6位车位编号",trigger:"blur",len:6}]},addPositionFormRule:{positionNumber:[{required:!0,message:"请输入6位车位编号",trigger:"blur",len:6}],deviceId:[{required:!0,message:"请输入设备编号",trigger:"blur"}],geomagnetismNumber:[{required:!0,message:"请输入地磁编号",trigger:"blur"}]},autherButtonShow:!1,distributionShow:!1,parkingLogManagerList:null,targetParkingManager:"",targetManagerNumberList:[],showEditParkingPositionBox:!1,editParkingPositionForm:{}}},computed:u()({},Object(l.b)(["userInfo"])),methods:{editParkingPosition:function(){var e=this;return a()(o.a.mark(function t(){var n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={id:e.editParkingPositionForm.id,vendorId:e.userInfo.vendorId,positionNumber:e.editParkingPositionForm.positionNumber,deviceId:e.editParkingPositionForm.deviceId,geomagnetismNumber:e.editParkingPositionForm.geomagnetismNumber},t.next=3,Object(c.n)(n);case 3:200===t.sent.code?(e.$Message.success("编辑提交成功"),e.$refs.table.updateData()):e.$Message.info("编辑违停信息失败"),e.$refs.table.updateData();case 6:case"end":return t.stop()}},t,e)}))()},findParkingLotManager:function(){var e=this;return a()(o.a.mark(function t(){var n,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={vendorId:e.userInfo.vendorId,superiorNumber:e.userInfo.managerNumber},t.next=3,Object(c.k)(n);case 3:r=t.sent,console.log(r),200===r.code?e.parkingLogManagerList=r.data:e.$Message.error("查询失败");case 6:case"end":return t.stop()}},t,e)}))()},onSelect:function(e,t){for(var n in this.targetManagerNumberList=[],e)this.targetManagerNumberList.push(e[n].positionNumber)},onSelectAll:function(e){for(var t in this.targetManagerNumberList=[],e)this.targetManagerNumberList.push(e[t].positionNumber)},changeTableNum:function(){this.$refs.table.updateData()},distributionConfrim:function(){var e=this;return a()(o.a.mark(function t(){var n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log(e.targetManagerNumberList),0!==e.targetManagerNumberList.length){t.next=4;break}return e.$Message.error("请选择车位"),t.abrupt("return",!1);case 4:if(e.targetParkingManager){t.next=7;break}return e.$Message.error("请选择分配给谁"),t.abrupt("return",!1);case 7:return n={parkingLotNumber:e.userInfo.parkingLotNumber,managerNumber:e.targetParkingManager,positionNumberList:e.targetManagerNumberList.toString()},t.next=10,Object(c.q)(n);case 10:200===t.sent.code&&e.$Message.success("分配成功");case 12:case"end":return t.stop()}},t,e)}))()},searchFind:function(){var e=this;delete this.queryData.positionNumber,delete this.queryData.parkingLotNumber,delete this.queryData.managerName,this.queryData={vendorId:this.userInfo.vendorId},this.queryData[this.findeCondition]=this.searchValue,this.$nextTick(function(){e.$refs.table.updateData()})},autherConfrim:function(){this.autherButtonShow=!1,this.$refs.table.updateData()},getAuother:function(){var e=this;return a()(o.a.mark(function t(){var n,r,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.$Message.loading({content:"加载中...",duration:0}),document.getElementById("qrCodeContent").innerHTML="",r={manageNumber:e.userInfo.managerNumber},t.next=5,Object(c.s)(r);case 5:200===(i=t.sent).code?(console.log(3),e.utils.qrcode("qrCodeContent",i.data,150),e.autherButtonShow=!0,setTimeout(n,0)):e.$Message.error("获取二维码失败");case 7:case"end":return t.stop()}},t,e)}))()},addPosition:function(){var e=this;return a()(o.a.mark(function t(){var n,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("新增车位"),n={deviceId:e.addPositionForm.deviceId,positionNumber:e.addPositionForm.positionNumber,geomagnetismNumber:e.addPositionForm.geomagnetismNumber,vendorId:e.userInfo.vendorId,parkingLotNumber:e.userInfo.parkingLotNumber},console.log(n),t.next=5,Object(c.c)(n);case 5:200===(r=t.sent).code?e.$Message.success("新增成功"):e.$Message.success(r.msg),e.$nextTick(function(){e.$refs.table.updateData()});case 8:case"end":return t.stop()}},t,e)}))()},deleteParkingPosition:function(e){var t=this;return a()(o.a.mark(function n(){var r,i;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r={id:e.id,status:1,positionNumber:e.positionNumber},n.next=3,Object(c.n)(r);case 3:i=n.sent,console.log(i),t.$nextTick(function(){t.$refs.table.updateData()});case 6:case"end":return n.stop()}},n,t)}))()}},mounted:function(){2===this.userInfo.role&&this.findParkingLotManager()},created:function(){this.queryData.vendorId=this.userInfo.vendorId,2===this.userInfo.role&&(this.queryData.parkingLotNumber=this.userInfo.parkingLotNumber)}},b={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"parkinglist"},[n("div",{staticClass:"searchContent"},[n("div",[n("Input",{attrs:{search:""},on:{"on-search":e.searchFind},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}},[n("Select",{staticStyle:{width:"120px"},attrs:{slot:"prepend"},slot:"prepend",model:{value:e.findeCondition,callback:function(t){e.findeCondition=t},expression:"findeCondition"}},e._l(e.conditionList,function(t){return n("Option",{key:t.key,attrs:{value:t.key}},[e._v(e._s(t.name))])}),1),e._v(" "),n("Button",{attrs:{slot:"append",icon:"ios-search"},on:{click:e.searchFind},slot:"append"})],1)],1),e._v(" "),n("div",[n("Input",{staticStyle:{width:"auto"},attrs:{search:"",placeholder:"输入单次查询条数"},on:{"on-search":e.changeTableNum},model:{value:e.num,callback:function(t){e.num=t},expression:"num"}},[n("Icon",{attrs:{slot:"suffix",type:"ios-search"},slot:"suffix"})],1)],1),e._v(" "),2===e.userInfo.role?n("div",[n("Button",{attrs:{type:"primary"},on:{click:function(t){e.distributionShow=!0}}},[e._v("分配车位")]),e._v(" "),n("Button",{attrs:{type:"primary"},on:{click:e.getAuother}},[e._v("授权路段管理员")]),e._v(" "),n("Button",{attrs:{type:"primary"},on:{click:function(t){e.showParkingAddBox=!0}}},[e._v("新增车位")])],1):e._e()]),e._v(" "),n("tabledata",{ref:"table",attrs:{"page-position":"center",columns:e.tableColumns,queryUrl:e.queryUrl,queryData:e.queryData,current:e.page,pageSize:e.num,type:e.type},on:{"on-select":e.onSelect,"on-select-all":e.onSelectAll}}),e._v(" "),n("Modal",{attrs:{title:"新增车位"},on:{"on-ok":e.addPosition,"on-cancel":function(t){e.showParkingAddBox=!1}},model:{value:e.showParkingAddBox,callback:function(t){e.showParkingAddBox=t},expression:"showParkingAddBox"}},[n("div",[n("Form",{ref:"formValidate",attrs:{model:e.addPositionForm,rules:e.addPositionFormRule,"label-width":100}},[n("FormItem",{attrs:{label:"车位编号",prop:"positionNumber"}},[n("Input",{attrs:{placeholder:"请输入车位编号"},model:{value:e.addPositionForm.positionNumber,callback:function(t){e.$set(e.addPositionForm,"positionNumber",t)},expression:"addPositionForm.positionNumber"}})],1),e._v(" "),n("FormItem",{attrs:{label:"设备编号",prop:"deviceId"}},[n("Input",{attrs:{placeholder:"请输入设备编号"},model:{value:e.addPositionForm.deviceId,callback:function(t){e.$set(e.addPositionForm,"deviceId",t)},expression:"addPositionForm.deviceId"}})],1),e._v(" "),n("FormItem",{attrs:{label:"地磁编号",prop:"geomagnetismNumber"}},[n("Input",{attrs:{placeholder:"请输入地磁编号"},model:{value:e.addPositionForm.geomagnetismNumber,callback:function(t){e.$set(e.addPositionForm,"geomagnetismNumber",t)},expression:"addPositionForm.geomagnetismNumber"}})],1)],1)],1)]),e._v(" "),n("Modal",{attrs:{width:"220",align:"center",title:"授权停车场管理"},on:{"on-ok":function(t){e.autherButtonShow=!1},"on-cancel":function(t){e.autherButtonShow=!1}},model:{value:e.autherButtonShow,callback:function(t){e.autherButtonShow=t},expression:"autherButtonShow"}},[n("div",{attrs:{id:"qrCodeContent"}})]),e._v(" "),n("Modal",{attrs:{width:"220",align:"center",title:"选择分配给谁"},on:{"on-ok":e.distributionConfrim,"on-cancel":function(t){e.distributionShow=!1}},model:{value:e.distributionShow,callback:function(t){e.distributionShow=t},expression:"distributionShow"}},[n("div",[n("Select",{staticStyle:{width:"100px"},attrs:{size:"small"},model:{value:e.targetParkingManager,callback:function(t){e.targetParkingManager=t},expression:"targetParkingManager"}},e._l(e.parkingLogManagerList,function(t){return n("Option",{key:t.managerNumber,attrs:{value:t.managerNumber}},[e._v(e._s(t.managerName))])}),1)],1)]),e._v(" "),n("Modal",{attrs:{title:"编辑车位信息"},on:{"on-ok":e.editParkingPosition,"on-cancel":function(t){e.showEditParkingPositionBox=!1}},model:{value:e.showEditParkingPositionBox,callback:function(t){e.showEditParkingPositionBox=t},expression:"showEditParkingPositionBox"}},[n("div",[n("Form",{ref:"formValidate",attrs:{model:e.editParkingPositionForm,rules:e.editPositionFormRule,"label-width":100}},[n("FormItem",{attrs:{label:"停车场名称"}},[n("Input",{attrs:{placeholder:"请输入停车场名称",disabled:""},model:{value:e.editParkingPositionForm.parkingLotName,callback:function(t){e.$set(e.editParkingPositionForm,"parkingLotName",t)},expression:"editParkingPositionForm.parkingLotName"}})],1),e._v(" "),n("FormItem",{attrs:{label:"停车场编号"}},[n("Input",{attrs:{placeholder:"请输入停车场编号",disabled:""},model:{value:e.editParkingPositionForm.parkingLotNumber,callback:function(t){e.$set(e.editParkingPositionForm,"parkingLotNumber",t)},expression:"editParkingPositionForm.parkingLotNumber"}})],1),e._v(" "),n("FormItem",{attrs:{label:"泊位号"}},[n("Input",{attrs:{placeholder:"请输入泊位号"},model:{value:e.editParkingPositionForm.positionNumber,callback:function(t){e.$set(e.editParkingPositionForm,"positionNumber",t)},expression:"editParkingPositionForm.positionNumber"}})],1),e._v(" "),n("FormItem",{attrs:{label:"设备编号"}},[n("Input",{attrs:{placeholder:"请输入设备编号"},model:{value:e.editParkingPositionForm.deviceId,callback:function(t){e.$set(e.editParkingPositionForm,"deviceId",t)},expression:"editParkingPositionForm.deviceId"}})],1),e._v(" "),n("FormItem",{attrs:{label:"地磁编号"}},[n("Input",{attrs:{placeholder:"请输入地磁编号"},model:{value:e.editParkingPositionForm.geomagnetismNumber,callback:function(t){e.$set(e.editParkingPositionForm,"geomagnetismNumber",t)},expression:"editParkingPositionForm.geomagnetismNumber"}})],1),e._v(" "),n("FormItem",{attrs:{label:"路段管理员"}},[n("Input",{attrs:{placeholder:"请输入路段管理员",disabled:""},model:{value:e.editParkingPositionForm.managerName,callback:function(t){e.$set(e.editParkingPositionForm,"managerName",t)},expression:"editParkingPositionForm.managerName"}})],1),e._v(" "),n("FormItem",{attrs:{label:"管理员联系方式"}},[n("Input",{attrs:{placeholder:"请输入管理员联系方式",disabled:""},model:{value:e.editParkingPositionForm.managerNumber,callback:function(t){e.$set(e.editParkingPositionForm,"managerNumber",t)},expression:"editParkingPositionForm.managerNumber"}})],1),e._v(" "),n("FormItem",{attrs:{label:"创建时间"}},[n("Input",{attrs:{placeholder:"请输入创建时间",disabled:""},model:{value:e.editParkingPositionForm.createTime,callback:function(t){e.$set(e.editParkingPositionForm,"createTime",t)},expression:"editParkingPositionForm.createTime"}})],1)],1)],1)])],1)},staticRenderFns:[]};var k=n("VU/8")(p,b,!1,function(e){n("f6tw")},"data-v-49d2b1eb",null);t.default=k.exports},f6tw:function(e,t){}});
//# sourceMappingURL=8.2830ff8adef135e0f5d2.js.map